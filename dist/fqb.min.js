!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("crypto")):"function"==typeof define&&define.amd?define(["crypto"],t):(e=e||self).FQB=t(e.crypto)}(this,function(e){"use strict";var t=(e=e&&e.hasOwnProperty("default")?e.default:e).createHmac,r=Object.prototype.hasOwnProperty,o=Array.isArray,i=function(){for(var e=[],t=0;256>t;++t)e.push("%"+((16>t?"0":"")+t.toString(16)).toUpperCase());return e}(),n=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},o=0;e.length>o;++o)void 0!==e[o]&&(r[o]=e[o]);return r},s={arrayToObject:n,assign:function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e},e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],i=0;t.length>i;++i)for(var n=t[i],s=n.obj[n.prop],c=Object.keys(s),a=0;c.length>a;++a){var f=c[a],p=s[f];"object"==typeof p&&null!==p&&-1===r.indexOf(p)&&(t.push({obj:s,prop:f}),r.push(p))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(o(r)){for(var i=[],n=0;r.length>n;++n)void 0!==r[n]&&i.push(r[n]);t.obj[t.prop]=i}}}(t),e},decode:function(e,t,r){var o=e.replace(/\+/g," ");if("iso-8859-1"===r)return o.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(o)}catch(e){return o}},encode:function(e,t,r){if(0===e.length)return e;var o=e;if("symbol"==typeof e?o=Symbol.prototype.toString.call(e):"string"!=typeof e&&(o=e+""),"iso-8859-1"===r)return escape(o).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var n="",s=0;o.length>s;++s){var c=o.charCodeAt(s);45!==c&&46!==c&&95!==c&&126!==c&&(48>c||c>57)&&(65>c||c>90)&&(97>c||c>122)?128>c?n+=i[c]:2048>c?n+=i[192|c>>6]+i[128|63&c]:c>=55296&&57344>c?(c=65536+((1023&c)<<10|1023&o.charCodeAt(s+=1)),n+=i[240|c>>18]+i[128|c>>12&63]+i[128|c>>6&63]+i[128|63&c]):n+=i[224|c>>12]+i[128|c>>6&63]+i[128|63&c]:n+=o.charAt(s)}return n},isBuffer:function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,i,s){if(!i)return t;if("object"!=typeof i){if(o(t))t.push(i);else{if(!t||"object"!=typeof t)return[t,i];(s&&(s.plainObjects||s.allowPrototypes)||!r.call(Object.prototype,i))&&(t[i]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(i);var c=t;return o(t)&&!o(i)&&(c=n(t,s)),o(t)&&o(i)?(i.forEach(function(o,i){if(r.call(t,i)){var n=t[i];n&&"object"==typeof n&&o&&"object"==typeof o?t[i]=e(n,o,s):t.push(o)}else t[i]=o}),t):Object.keys(i).reduce(function(t,o){var n=i[o];return t[o]=r.call(t,o)?e(t[o],n,s):n,t},c)}},c=String.prototype.replace,a=/%20/g,f={RFC1738:"RFC1738",RFC3986:"RFC3986"},p=s.assign({default:f.RFC3986,formatters:{RFC1738:function(e){return c.call(e,a,"+")},RFC3986:function(e){return e+""}}},f),l=Object.prototype.hasOwnProperty,u={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},h=Array.isArray,d=Array.prototype.push,y=function(e,t){d.apply(e,h(t)?t:[t])},m=Date.prototype.toISOString,_=p.default,g={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:s.encode,encodeValuesOnly:!1,format:_,formatter:p.formatters[_],indices:!1,serializeDate:function(e){return m.call(e)},skipNulls:!1,strictNullHandling:!1},b=function e(t,r,o,i,n,c,a,f,p,l,u,d,m){var _,b=t;if("function"==typeof a?b=a(r,b):b instanceof Date?b=l(b):"comma"===o&&h(b)&&(b=b.join(",")),null===b){if(i)return c&&!d?c(r,g.encoder,m,"key"):r;b=""}if("string"==typeof(_=b)||"number"==typeof _||"boolean"==typeof _||"symbol"==typeof _||"bigint"==typeof _||s.isBuffer(b))return c?[u(d?r:c(r,g.encoder,m,"key"))+"="+u(c(b,g.encoder,m,"value"))]:[u(r)+"="+u(b+"")];var v,A=[];if(void 0===b)return A;if(h(a))v=a;else{var j=Object.keys(b);v=f?j.sort(f):j}for(var O=0;v.length>O;++O){var P=v[O];n&&null===b[P]||(h(b)?y(A,e(b[P],"function"==typeof o?o(r,P):r,o,i,n,c,a,f,p,l,u,d,m)):y(A,e(b[P],r+(p?"."+P:"["+P+"]"),o,i,n,c,a,f,p,l,u,d,m)))}return A},v=function(e,t){var r,o=e,i=function(e){if(!e)return g;if(null!=e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||g.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=p.default;if(void 0!==e.format){if(!l.call(p.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var o=p.formatters[r],i=g.filter;return("function"==typeof e.filter||h(e.filter))&&(i=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:g.addQueryPrefix,allowDots:void 0===e.allowDots?g.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:g.charsetSentinel,delimiter:void 0===e.delimiter?g.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:g.encode,encoder:"function"==typeof e.encoder?e.encoder:g.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:g.encodeValuesOnly,filter:i,formatter:o,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:g.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:g.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:g.strictNullHandling}}(t);"function"==typeof i.filter?o=(0,i.filter)("",o):h(i.filter)&&(r=i.filter);var n=[];if("object"!=typeof o||null===o)return"";var s=u[t&&t.arrayFormat in u?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices"];r||(r=Object.keys(o)),i.sort&&r.sort(i.sort);for(var c=0;r.length>c;++c){var a=r[c];i.skipNulls&&null===o[a]||y(n,b(o[a],a,s,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.formatter,i.encodeValuesOnly,i.charset))}var f=n.join(i.delimiter),d=!0===i.addQueryPrefix?"?":"";return i.charsetSentinel&&(d+="iso-8859-1"===i.charset?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),f.length>0?d+f:""},A=function(){function e(e,t,r){this._name=e||"",this._modifiers={},this._fields=t||[],this._compiledValues=[],r&&this.limit(r)}return e.prototype.modifiers=function(e){return Object.assign(this._modifiers,e),this},e.prototype.getModifiers=function(){return this._modifiers},e.prototype.getModifier=function(e){return this._modifiers[e]?this._modifiers[e]:null},e.prototype.limit=function(t){return this._modifiers[e.PARAM_LIMIT]=t,this},e.prototype.getLimit=function(){return this._modifiers[e.PARAM_LIMIT]},e.prototype.fields=function(){for(var e=[],t=0;arguments.length>t;t++)e[t]=arguments[t];return this._fields=this._fields.concat(1===e.length&&Array.isArray(e[0])?e[0]:e),this},e.prototype.getFields=function(){return this._fields},e.prototype.resetCompiledValues=function(){this._compiledValues=[]},e.prototype.compileModifiers=function(){Object.keys(this._modifiers).length&&(this._compiledValues=v(this._modifiers).split("&"))},e.prototype.compileFields=function(){this._fields.length&&this._compiledValues.push(e.PARAM_FIELDS+"="+this._fields.join())},e.prototype.compileUrl=function(){var e="";return this._compiledValues.length&&(e="?"+this._compiledValues.join("&")),"/"+this._name+e},e.prototype.asUrl=function(e){return this.resetCompiledValues(),e&&this.addAppSecretProofModifier(e),this.compileModifiers(),this.compileFields(),this.compileUrl()},e.prototype.toString=function(){return this.asUrl()},e.prototype.addAppSecretProofModifier=function(r){var o=this.getModifier(e.PARAM_ACCESS_TOKEN);o&&(this._modifiers[e.PARAM_APP_SECRET_PROOF]=t("sha256",r).update(o).digest("hex"))},e.PARAM_FIELDS="fields",e.PARAM_LIMIT="limit",e.PARAM_ACCESS_TOKEN="access_token",e.PARAM_APP_SECRET_PROOF="appsecret_proof",e}(),j=function(e,t){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return function(e,t){function r(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.toEndpoints=function(){var e=[];return this.getChildEdges().forEach(function(t){e.push("/"+t.join("/"))}),e},t.prototype.getChildEdges=function(){var e=this,r=[],o=!1;return this._fields.forEach(function(i){i instanceof t&&(o=!0,i.getChildEdges().forEach(function(t){r.push([e._name].concat(t))}))}),o||r.push([this._name]),r},t.prototype.compileModifiers=function(){var e=this;if(Object.keys(this._modifiers).length){var t=[];Object.keys(this._modifiers).forEach(function(r){t.push(encodeURIComponent(r)+"("+encodeURIComponent(e._modifiers[r])+")")}),this._compiledValues.push("."+t.join("."))}},t.prototype.compileFields=function(){if(this._fields.length){var e=[];this._fields.forEach(function(r){e.push(r instanceof t?r.asUrl():encodeURIComponent(r))}),this._compiledValues.push("{"+e.join(",")+"}")}},t.prototype.compileUrl=function(){var e="";return this._compiledValues.length&&(e=this._compiledValues.join("")),this._name+e},t}(A);return function(){function e(e,t){void 0===e&&(e={}),this._graphNode=new A(t),this._config=e,e.hasOwnProperty("accessToken")&&this.accessToken(e.accessToken),e.hasOwnProperty("graphVersion")&&this.graphVersion(e.graphVersion),e.hasOwnProperty("appSecret")&&(this._appSecret=e.appSecret),e.hasOwnProperty("enableBetaMode")&&!0===e.enableBetaMode&&(this._enableBetaMode=!0)}return e.prototype.node=function(t){return new e(this._config,t)},e.prototype.edge=function(e,t){return new O(e,t)},e.prototype.fields=function(){for(var e=[],t=0;arguments.length>t;t++)e[t]=arguments[t];return this._graphNode.fields(1===e.length&&Array.isArray(e[0])?e[0]:e),this},e.prototype.accessToken=function(e){return this._graphNode.modifiers(Object.assign(this._graphNode.getModifiers(),{access_token:e})),this},e.prototype.graphVersion=function(e){return this._graphVersion=e,this},e.prototype.limit=function(e){return this._graphNode.limit(e),this},e.prototype.modifiers=function(e){return this._graphNode.modifiers(e),this},e.prototype.asUrl=function(){return""+this.getHostname()+this.asEndpoint()},e.prototype.asEndpoint=function(){var e="";return this._graphVersion&&(e="/"+this._graphVersion),""+e+this._graphNode.asUrl(this._appSecret)},e.prototype.toString=function(){return this.asUrl()},e.prototype.getHostname=function(){return this._enableBetaMode?e.BASE_GRAPH_URL_BETA:e.BASE_GRAPH_URL},e.BASE_GRAPH_URL="https://graph.facebook.com",e.BASE_GRAPH_URL_BETA="https://graph.beta.facebook.com",e}()});
